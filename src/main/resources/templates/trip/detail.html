<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layout}">
<head>
    <meta charset="UTF-8">
    <title>ÎßûÏ∂§Ï∂îÏ≤ú Î¶¨Ïä§Ìä∏</title>
    <script src=""></script>
    <style>
        .splide {
            width: 800px;
            height: 500px;
        }

        .splide__slide {
            padding: 1rem;
        }

        .splide__slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>
<div layout:fragment="content" class="container">
    <script src="/public/js/splideTest.js"></script>
    <h1 class="my-4">ÎßûÏ∂§Ï∂îÏ≤ú ÏÉÅÏÑ∏</h1>



<!--    <div class="splide">-->
<!--        <div class="splide__track">-->
<!--            <ul class="splide__list">-->
<!--                <li class="splide__slide"><img src="image1.jpg"></li>-->
<!--                <li class="splide__slide"><img src="image2.jpg"></li>-->
<!--                <li class="splide__slide"><img src="image3.jpg"></li>-->
<!--            </ul>-->
<!--        </div>-->
<!--    </div>-->

    <section id="tripCont">
        <div class="row">
            <div class="col-5">
                <div class="card border-dark border-opacity-25">
                    <div class="card-header p-3 bg-transparent border-dark border-opacity-25">
                        <div class="d-flex justify-content-around">
                            <p class="card-text d-flex flex-column align-items-center g-2 mb-0">
                                <span class="bi bi-heart mb-1"></span>
                                Ï¢ãÏïÑÏöî
                                <span>156</span>
                            </p>
                            <p class="card-text d-flex flex-column align-items-center g-2 mb-0">
                                <span class="bi bi-heart mb-1"></span>
                                Î∂ÅÎßàÌÅ¨
                                <span>156</span>
                            </p>
                            <p class="card-text d-flex flex-column align-items-center g-2 mb-0">
                                <span class="bi bi-heart mb-1"></span>
                                Î¶¨Î∑∞
                                <span>156</span>
                            </p>
                            <p class="card-text d-flex flex-column align-items-center g-2 mb-0">
                                <span class="bi bi-heart mb-1"></span>
                                Î∞©Î¨∏
                                <span>156</span>
                            </p>
                            <p class="card-text d-flex flex-column align-items-center g-2 mb-0">
                                <span class="bi bi-heart mb-1"></span>
                                Ï°∞ÌöåÏàò
                                <span>156</span>
                            </p>
                        </div>
                    </div> <!-- // Ï¢ãÏïÑÏöî,Î∂ÅÎßàÌÅ¨,Î¶¨Î∑∞,Î∞©Î¨∏,Ï°∞ÌöåÏàò -->

                    <div class="card-body text-success">
                        <h5 class="card-title">Ï†úÏ£ºÎèÑÏóêÏÑú Ï¶êÍ∏∞Îäî Î¥ÑÍΩÉ Ïó¨Ìñâ</h5>
                        <p class="card-text">
                            <span>‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</span>
                            <small>156</small>
                        </p>
                        <p class="card-text">
                            #enfj#enfp#istj

                            mbti / Ìï¥ÏãúÌÉúÍ∑∏
                        </p>
                        <h6>Í∏∞Î≥∏Ï†ïÎ≥¥</h6>
                        <p class="card-text">
                            Ï£ºÏÜå
                            <span>ÏÑúÍ∑ÄÌè¨</span>
                        </p>
                        <p class="card-text">
                            Ïó∞ÎùΩÏ≤ò
                            <span>01011112222</span>
                        </p>
                        <p class="card-text">
                            ÌôàÌéòÏù¥ÏßÄ
                            <span>https://www.visitjeju.net/kr/</span>
                        </p>
                        <p class="card-text">
                            Îì±Î°ùÏùº / ÏàòÏ†ïÏùº
                            <span></span>
                        </p>

                    </div> <!---->

                    <div class="card-footer bg-transparent border-dark border-opacity-25">
                        <label for="" class="form-label">ÏÜåÍ∞úÍ∏Ä</label>
                        <textarea name="" id="" rows="4" class="form-control" th:text="${t.content}"></textarea>
                    </div>
                </div>
            </div> <!-- Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏ (ÏôºÏ™Ω) -->


            <div class="col-7">
                <div class="card" style="border:none;">

                    <!--<div class="card-header d-flex justify-content-between align-items-center">
                        <strong th:text="${t.area}"></strong>
                        <i class="bi bi-heart text-danger"></i>
                    </div>-->

                    <!-- imgs Í∞Ä null Ïù¥ ÏïÑÎãàÎ©¥ Î≥¥Ïù¥Í∏∞! null Ïù¥Î©¥ ÏïàÎ≥¥Ïù¥Í∏∞! -->
                    <div th:id="'carousel'+${t.tId}" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            <div class="carousel-item rounded-top overflow-hidden" th:each="img,state : ${t.imgs}"
                                 th:classappend="${state.first}?'active':''">
                                <img th:if="${t.imgs!=null}" th:src="@{'{path}'(path=${img.imgPath})}"
                                     class="d-block w-100" style="object-fit: contain">
                            </div>
                        </div>
                        <button class="carousel-control-prev" type="button" th:data-bs-target="'#carousel'+${t.tId}"
                                data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" th:data-bs-target="'#carousel'+${t.tId}"
                                data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                    <div class="pt-3">
                        <p class="d-flex justify-content-between align-items-center">
                            <span>
                                Ïó¨ÌñâÍ∞ÄÏùò Î¶¨Î∑∞ <strong>52</strong>
                            </span>

                            <a href="javascript:void(0)" th:onclick="reviewRegistModal.show()">
                                Î¶¨Î∑∞ ÏûëÏÑ±ÌïòÍ∏∞
                            </a>
<!--                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="reviewRegistModal">-->
<!--                                Î¶¨Î∑∞ ÏûëÏÑ±ÌïòÍ∏∞-->
<!--                            </button>-->

                            <!-- Modal -->
                        <div class="modal fade" id="reviewRegistModal" tabindex="-1">
                            <div class="modal-dialog">
                                <form class="modal-content" name="reviewRegistForm" method="post" enctype="multipart/form-data">
                                    <input type="hidden" name="tId">
                                    <input type="hidden" name="trId">
                                    <input type="hidden" name="imgPath">

                                    <div class="modal-header">
                                        <h1 class="modal-title fs-5" id="exampleModalLabel">Î¶¨Î∑∞ ÏûëÏÑ±ÌïòÍ∏∞</h1>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <p>
                                            ÌèâÍ∞Ä <span>‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</span>
                                        </p>
                                        <p>

                                            Î∞©Î¨∏ <span> <i class="bi bi-record-circle text-danger"></i></span>
                                            Î∞©Î¨∏Ï†Ñ <span>  <i class="bi bi-circle text-dark text-opacity-25"></i></span>
                                        </p>

                                        <p class="form-floating">
                                            <input type="text" name="uId" readonly class="form-control" placeholder="Í∏ÄÏì¥Ïù¥">
                                            <label>Ïû•ÏÜåÏù¥Î¶Ñ</label>
                                        </p>

                                        <p id="imgCont">
                                            <button id="imgAddBtn" class="btn btn-danger w-100" type="button">
                                                Ïù¥ÎØ∏ÏßÄ
                                                <i class="bi bi-plus-square"></i>
                                            </button>
                                        </p>

                                        <!--                                        <p>-->
<!--                                            <input type="file" name="img" class="form-control"> &lt;!&ndash; ÏàòÏ†ïÌïòÎäî Ïù¥ÎØ∏ÏßÄ &ndash;&gt;-->
<!--                                        </p>-->
                                        <p class="form-floating">
                                            <input type="text" name="content" class="form-control" placeholder="ÎÇ¥Ïö©">
                                            <label>ÎÇ¥Ïö©</label>
                                        </p>

                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Ï∑®ÏÜå</button>
                                        <button type="submit" class="btn btn-outline-danger">Îì±Î°ù</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <hr>
                        <p>
                            <span>
                                <i class="bi bi-record-circle text-danger"></i>
                                Ï¢ãÏïÑÏöîÏàú
                            </span>
                            <span>
                                <i class="bi bi-circle text-dark text-opacity-25"></i>
                                ÏµúÏã†Ïàú
                            </span>
                        </p>
                        <hr>
                        <div>
                            <div class="mb-3 d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <img src="/public/img/trip/airplane.jpg"
                                         class="me-2 d-inline-block border rounded-circle" style="width:30px; height: 30px;"
                                         alt="">
                                    <div>
                                        Í∞ÄÎ≥¥ÏûêÍ≥†Ïûâ
                                        <!--<p class="mb-0">
                                            <small>Î¶¨Î∑∞<span>17</span></small>
                                            <small>ÌåîÎ°úÏõå<span>5</span></small>
                                        </p>-->
                                    </div>
                                </div> <!-- Ïú†Ï†Ä ÌîÑÎ°úÌïÑ,ÎãâÎÑ§ÏûÑ,ÏûëÏÑ± Î¶¨Î∑∞Í∞úÏàò,ÌåîÎ°úÏõåÏàò -->
                                <div class="dropdown">
                                    <a href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="bi bi-three-dots-vertical text-muted"></i>
                                    </a>
                                    <ul class="dropdown-menu">
                                        <!-- Î°úÍ∑∏Ïù∏ + Î°úÍ∑∏Ïù∏Ïú†Ï†ÄÏôÄ Í≤åÏãúÍ∏ÄÏùò Ïú†Ï†ÄÍ∞Ä ÎèôÏùºÌï†Îïå Î≥¥Ïù¥Í∏∞! -->
                                        <li>
                                            <!--                                        <li th:if="${session.loginUser!=null}">-->
                                            <a class="dropdown-item text-muted" th:href="@{'/trip/{tId}/modify.do'(tId=${t.tId})}">ÏàòÏ†ïÌèº</a>
                                        </li>
                                        <li><a class="dropdown-item text-muted" th:href="@{'/trip/{tId}/remove.do'(tId=${t.tId})}">ÏÇ≠Ï†ú</a></li>
                                        <li>
                                            <a class="dropdown-item text-danger" href="#">
                                            <i class="bi bi-bell-fill"></i>Ïã†Í≥†
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>


                            <div>
                                <div>
                                    <p>ÌòëÏû¨Ìï¥ÏàòÏöïÏû•ÏóêÏÑú Î∞îÎùºÎ≥∏ ÎÖ∏ÏùÑÏùÄ ÏôÑÎ≤ΩÌñàÏñ¥Ïöî‚ô•Ô∏è Ìï¥Í∞ÄÏßàÎ¨¥Î†µ üíô #Ïó¨Î¶Ñ #Î∞îÎã§ #Ï†úÏ£º #Ïó¨Ìñâ</p>
                                </div>
                                <div>
                                    <div class="row mb-2">
                                        <div class="col">
                                            <img class="img-fluid" src="/public/img/trip/jeju1.jpeg" alt="">
                                        </div>
                                        <div class="col">
                                            <img class="img-fluid" src="/public/img/trip/jeju1.jpeg" alt="">
                                        </div>
                                        <div class="col">
                                            <img class="img-fluid" src="/public/img/trip/jeju1.jpeg" alt="">
                                        </div>
                                        <div class="col">
                                            <img class="img-fluid" src="/public/img/trip/jeju1.jpeg" alt="">
                                        </div>
                                        <div class="col">
                                            <img class="img-fluid" src="/public/img/trip/jeju1.jpeg" alt="">
                                        </div>
                                    </div>
                                    <!--  Ïù¥ÎØ∏ÏßÄ / Î∞òÎ≥µÎ¨∏-->
                                    <div>
                                        <p class="text-danger me-2 badge border rounded-5 border-danger border-opacity-50">
                                            <i class="bi bi-hash"></i><span>Ïó¨Î¶Ñ</span>
                                        </p>
                                        <p class="text-danger me-2 badge border rounded-5 border-danger border-opacity-50">
                                            <i class="bi bi-hash"></i><span>Î∞îÎã§</span>
                                        </p>
                                        <p class="text-danger me-2 badge border rounded-5 border-danger border-opacity-50">
                                            <i class="bi bi-hash"></i><span>Ï†úÏ£º</span>
                                        </p>
                                        <p class="text-danger me-2 badge border rounded-5 border-danger border-opacity-50">
                                            <i class="bi bi-hash"></i><span>Ïó¨Ìñâ</span>
                                        </p>
                                    </div> <!-- Ìï¥ÏãúÌÉúÍ∑∏ Î∞òÎ≥µÎ¨∏ -->
                                </div>
                                <p>
                                    <span class="me-2">
                                        ÏûëÏÑ±Ïùº :
                                        <small th:text="${#dates.format(t.postTime,'yyy.MM.dd')}"></small>
                                        <!-- date.format(Îç∞Ïù¥Ìä∏Í∞ùÏ≤¥, Ìè¨Îß∑) ÏúºÎ°ú ÎÇ†Ïßú ÏòàÏÅòÍ≤å ÏàòÏ†ïÌïòÍ∏∞ -->
                                    </span>
                                    <span>‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</span>
                                    <span>Î∞©Î¨∏</span>
                                </p>
                                <p>
                                    ÎåìÍ∏ÄÏûëÏÑ±Ìèº ÎÑ£Í∏∞
                                    <a href="">Ï¢ãÏïÑÏöî</a>
                                    <a href="">ÎåìÍ∏ÄÏì∞Í∏∞</a>
                                </p>

                            </div>

                        </div>
                        <form action="">
                            <div class="row align-items-center">
                                <div class="col-3">
                                    <input placeholder="Î∂ÄÎ™®ÎåìÍ∏Ä" type="text" readonly class="form-control">
                                </div>
                                <div class="col">
                                    <input placeholder="ÎåìÍ∏Ä" type="text" class="form-control">
                                </div>
                                <button class="btn col-auto">
                                    <i class="bi bi-send"></i>
<!--                                    Îì±Î°ù-->
                                </button>
                                <!-- input ÌÉúÍ∑∏Î°ú Î≤ÑÌäº Î™®ÏñëÎÇ¥Í∏∞ -->
                                <label class="col-auto">
                                    <i class="bi bi-image"></i>
                                    <input class="d-none" type="file" name="img">
                                </label>
                            </div>
                        </form>
                    </div>


                </div>
                <!-- Í≤åÏãúÍ∏Ä Ïù¥ÎØ∏ÏßÄ, Î¶¨Î∑∞,ÎåìÍ∏Ä (Ïò§Î•∏Ï™Ω) -->

                <div id="replyModifyModal" class="modal">
                    <div class="modal-dialog">
                        <form class="modal-content" name="replyModifyForm" method="post" enctype="multipart/form-data">
                            <input type="hidden" name="bId"> <!-- Í≤åÏãúÍ∏ÄÏïÑÏù¥Îîî Î∞õÍ∏∞ -->
                            <input type="hidden" name="brId">
                            <input type="hidden" name="imgPath"> <!-- hidden ÌÉÄÏûÖ : Ïà®Í≤®ÏÑú ÏÑúÎ≤Ñ(ÏöîÏ≤≠Î©îÏÑ∏ÏßÄ Î≥∏Î¨∏)Ïóê Ï†ÑÎã¨ -->
                            <div class="modal-header">
                                <h5 class="modal-title">Î¶¨Ìîå ÏàòÏ†ïÌèº</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div id="replyModifyModalBody" class="modal-body"> <!-- ÎÇ¥Ïö©Ïù¥ Îì§Ïñ¥Í∞ÄÎäî ÌÉúÍ∑∏ÏóêÎäî id Î•º Ï£ºÎäîÍ≤ÉÏù¥ Ï¢ãÎã§. -->
                                <p class="form-floating">
                                    <input type="text" name="uId" readonly class="form-control" placeholder="Í∏ÄÏì¥Ïù¥">
                                    <label>Í∏ÄÏì¥Ïù¥</label>
                                </p>
                                <p>
                                    <img name="imgPath" class="img-thumbnail" src="" alt="ÎåìÍ∏Ä Ïù¥ÎØ∏ÏßÄ"> <!-- ÏõêÎ≥∏ Ïù¥ÎØ∏ÏßÄ -->
                                </p>
                                <p class="form-floating">
                                    <input type="text" name="parentBrId" readonly class="form-control" placeholder="Ï∞∏Ï°∞ÌïòÎäî Î∂ÄÎ™® ÎåìÍ∏Ä">
                                    <label>Ï∞∏Ï°∞ÌïòÎäî Î∂ÄÎ™® ÎåìÍ∏Ä</label>
                                </p>
                                <p>
                                    <input type="file" name="img" class="form-control"> <!-- ÏàòÏ†ïÌïòÎäî Ïù¥ÎØ∏ÏßÄ -->
                                </p>
                                <p class="form-floating">
                                    <input type="text" name="content" class="form-control" placeholder="ÎÇ¥Ïö©">
                                    <label>ÎÇ¥Ïö©</label>
                                </p>
                            </div>
                            <!-- Î™®Îã¨Ï∞Ω Î≤ÑÌäº / ÏàòÏ†ï ÏÇ≠Ï†úÎ≤ÑÌäºÎßå ÏûàÎã§. ( Ï¥àÍ∏∞ÌôîÎäî ÏÑúÎ≤ÑÏÇ¨Ïù¥ÎìúÎ†åÎçîÎ°ú Í∞íÏùÑ Í∞ÄÏ†∏ÏôÄÏïº Ï¥àÍ∏∞ÌôîÍ∞Ä Í∞ÄÎä•ÌïòÎã§. Ïó¨Í∏∞ÏÑúÎäî ÏïàÎê®)-->
                            <div class="modal-footer">
                                <button id="removeReplyBtn" type="button" class="btn btn-danger">ÏÇ≠Ï†ú</button>
                                <button type="submit" class="btn btn-primary">ÏàòÏ†ï</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div> <!-- Ïò§Î•∏Ï™Ω Í∑∏Î¶¨Îìú -->
        </div> <!-- // Í∑∏Î¶¨Îìú row -->
    </section>
    <script> // Î¶¨Î∑∞Îì±Î°ù Î™®Îã¨Ï∞Ω Ïù¥ÎØ∏ÏßÄ Î≤ÑÌäº
        const imgAddBtn = document.getElementById("imgAddBtn");
        const imgCont = document.getElementById("imgCont");
        imgAddBtn.addEventListener("click", (e) => {
            imgCont.insertAdjacentHTML("beforeend", imgInputComponent());
        });
        function imgInputComponent(label = "Ïù¥ÎØ∏ÏßÄ", name = "img") { // üî• label, name ÎÑ£Îäî Ïù¥Ïú†?
            return `
                 <p class="input-group mt-2">
                    <label class="input-group-text click">${label}</label>
                    <input class="form-control" type="file" name="${name}">

                    <button type="button" class="btn btn-danger" onclick="this.closest('.input-group').remove()">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </p>
            `
        }
    </script>
    <script th:inline="javascript">
        const reviewRegistModal = new bootstrap.Modal(document.getElementById("reviewRegistModal"), {}); // {} Ïù¥Í≤å Î≠êÏßÄ?
        const reviewRegistForm = document.forms["reviewRegistForm"];
        reviewRegistForm.onsubmit=registReview;



        async function registReview(e){
            e.preventDefault();
            const data=new FormData(reviewRegistForm);
            let url="/review/handler.do"
            const resp=await fetch(url,{method:"POST", body:data});
            if(resp.status==200){
                const json=await resp.json(); // ÏùëÎãµÍ∞ùÏ≤¥ json Í∞ùÏ≤¥Î°ú ÌååÏã±
                if(json.register>0){
                    alert("Îì±Î°ùÏÑ±Í≥µ");
                    // ÏÉàÎ°úÍ≥†Ïπ®
                    // await load
                }
                reviewRegistModal.show();
                console.log(json);
            } else {
                alert("Îì±Î°ùÏã§Ìå® status: " + resp.status);
            }
        }



        async function loadModifyReply(tId) { // ÏàòÏ†ïÌèº Î≤ÑÌäº ÌÅ¥Î¶≠Ïãú Ïã§ÌñâÎêòÎäî Ìï®Ïàò
            // alert(brId); // Í∏∞Îä•ÌïòÎäîÏßÄ ÌÖåÏä§Ìä∏
            let url = `/review/${tId}/detail.do`;
            const resp = await fetch(url); // Ìò∏Ï∂ú
            if (resp.status == 200) {
                const json = await resp.json();
                // json : {"brId":117,"parentBrId":116,"postTime":"2023-04-06T19:05:46.000+00:00","updateTime":"2023-04-06T19:05:46.000+00:00","status":"PUBLIC","imgPath":"/public/img/reply/1680807946731_4416.png","content":"ÏïàÎÖï","likes":null,"replies":[],"uid":"mlucky","bid":4}
                // ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏Í∞Ä uid, bid ÎåÄÏÜåÎ¨∏Ïûê Íµ¨Î∂ÑÏùÑ Î™ªÌïúÎã§ => BoardReplyDto Ïóê  @JsonProperty("bId") ÏÜçÏÑ± Ï∂îÍ∞Ä
                // Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏïÑÎãàÎùº input ÏöîÏÜåÎßå Ï∞æÍ≥† ÏûàÏñ¥ÏÑú Ïù¥ÎØ∏ÏßÄ ÌååÏùºÏùÑ Î™ªÏ∞æÎäîÎã§.
                // => replyModifyForm.querySelectorAll("input").forEach((input)=>{
                replyModifyForm.querySelectorAll("[name]").forEach((input) => { // => üçèÏù¥ÎØ∏ÏßÄÌÉúÍ∑∏Ïùò value Ïóê Ïù¥ÎØ∏ÏßÄÍ∞Ä Îì§Ïñ¥Ïò®Îã§
                    let key = input.name;
                    // üçâinput.value : input type='file' ÏóêÎäî value Í∞Ä ÏóÜÏùå
                    // json Ïùò key Í∞íÏù¥ ÏûàÎäîÍ≤ÉÎßå ÎåÄÏûÖ (file Ïù¥ÎØ∏ÏßÄ Ï†úÏô∏)
                    if (key in json) {
                        if (key === "imgPath") { // üçèÏù¥ÎØ∏ÏßÄ input ÌÉúÍ∑∏Ïùò value => name ÏúºÎ°ú Ïù¥ÎØ∏ÏßÄ Î∂àÎü¨Ïò§Í∏∞
                            input.src = json[key]; // input ÏöîÏÜå
                        }
                        input.value = json[key]; // src ÏöîÏÜå // json ÏóêÏÑú ÌÇ§Í∞íÏúºÎ°ú Í∞ÄÏ†∏Ïò®ÎäîÍ≤É  json[brId] = 117 Î•º input value Ïóê ÎåÄÏûÖ
                    }
                })
                replyModifyModal.show();
            } else {
                alert("Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå® status:" + resp.status);
            }

        }


    </script>

</div>
</html>